(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6777:function(e,t,n){Promise.resolve().then(n.bind(n,1876)),Promise.resolve().then(n.bind(n,7666)),Promise.resolve().then(n.bind(n,971)),Promise.resolve().then(n.bind(n,8675)),Promise.resolve().then(n.bind(n,7615)),Promise.resolve().then(n.t.bind(n,5250,23))},7723:function(e,t,n){"use strict";n.d(t,{$J:function(){return o},CR:function(){return r},VV:function(){return c},_q:function(){return a}}),n(5355);var s=n(1162);(0,s.$)("9d7f909a3caa3ade7084d546f26deb80f9cbbcd2");var a=(0,s.$)("6becc9296ec16a583b265ab89f2ebc3af8a23b05"),r=(0,s.$)("542960be04681112d741a2a3f5e8fc0f53af5c16"),o=(0,s.$)("99c2275e86d9edd182d20fd717ee39fb305cf39f"),c=(0,s.$)("912709f89d08a3096f530f5e3d245e6fe7302994")},1876:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var s=n(7437),a=n(2265),r=n(7723),o=n(7615);function c(e){let{selectedMonth:t}=e,[n,c]=(0,a.useState)(!1),[l,i]=(0,a.useState)([]),[d,u]=(0,a.useState)(!1),h=async()=>{u(!0);try{console.log("Vyhodnocuji měs\xedc:",t);let e=await (0,r.$J)(t);console.log("V\xfdsledek vyhodnocen\xed:",e),e.success&&e.winners?(i(e.winners),c(!0),console.log("Modal se otev\xedr\xe1 s v\xedtězi:",e.winners)):(console.log("Ž\xe1dn\xed v\xedtězov\xe9 nebo chyba:",e),i([]),c(!0))}catch(e){console.error("Chyba při vyhodnocov\xe1n\xed:",e)}finally{u(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:h,disabled:d,className:"btn btn-secondary",children:d?"⏳ Vyhodnocuji...":"\uD83C\uDFC6 Vyhodnotit měs\xedc"}),(0,s.jsx)(o.default,{isOpen:n,onClose:()=>c(!1),winners:l,month:t})]})}},7666:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return r}});var s=n(7437),a=n(4114);function r(){let{isAuthenticated:e,logout:t}=(0,a.useAuthContext)();return e?(0,s.jsx)("button",{onClick:t,className:"logout-btn",title:"Odhl\xe1sit se (30 minut)",children:"\uD83D\uDD13 Odhl\xe1sit"}):null}},971:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var s=n(7437),a=n(4033),r=n(6771);function o(e){let{currentMonth:t,selectedMonth:n}=e,o=(0,a.useRouter)(),c=(0,a.useSearchParams)(),l=e=>{let t=new URLSearchParams(c);t.set("month",e),o.push("/?".concat(t.toString()))},i=(()=>{let e=[],[n,s]=t.split("-").map(Number);for(let t=11;t>=0;t--){let a=n,r=s-t;r<=0&&(r+=12,a-=1);let o="".concat(a,"-").concat(r.toString().padStart(2,"0"));e.push(o)}return e})();return(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,s.jsx)("span",{style:{color:"#374151",fontWeight:"500"},children:"Měs\xedc:"}),(0,s.jsx)("select",{value:n,onChange:e=>l(e.target.value),style:{padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",background:"white",color:"#374151",fontWeight:"500"},children:i.map(e=>(0,s.jsxs)("option",{value:e,children:[(0,r.ZY)(e)," ",e.split("-")[0],e===t?" (aktu\xe1ln\xed)":""]},e))})]})}},8675:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var s=n(7437),a=n(6691),r=n.n(a),o=n(2265),c=n(7723),l=n(4114);function i(e){let{player:t}=e,[n,a]=(0,o.useState)(t.points),[i,d]=(0,o.useState)(!1),{isAuthenticated:u,showPasswordModal:h}=(0,l.useAuthContext)(),m=async()=>{if(!(n>=3)&&!i){if(!u){h();return}d(!0),a(e=>Math.min(3,e+1));try{(await (0,c._q)(t.id)).success||a(t.points)}catch(e){a(t.points)}finally{d(!1)}}},v=async()=>{if(!(n<=0)&&!i){if(!u){h();return}d(!0),a(e=>Math.max(0,e-1));try{(await (0,c.CR)(t.id)).success||a(t.points)}catch(e){a(t.points)}finally{d(!1)}}};return(0,s.jsxs)("div",{className:"player-container",children:[(0,s.jsxs)("div",{className:"player-card",children:[(0,s.jsx)("div",{className:"avatar",children:(0,s.jsx)(r(),{src:"/avatars/".concat(t.avatar_file),alt:"Avatar ".concat(t.name),width:120,height:120})}),(0,s.jsx)("h3",{className:"player-name",children:t.name})]}),n>0&&(0,s.jsx)("div",{className:"sandwiches",children:Array(n).fill(0).map((e,t)=>(0,s.jsx)(r(),{src:"/images/chleb.png",alt:"chleb\xedček",width:28,height:28,className:"sandwich-icon"},t))}),(0,s.jsxs)("div",{className:"buttons",children:[(0,s.jsx)("button",{onClick:v,disabled:n<=0||i,className:"btn-circle ".concat(u?"":"btn-locked"),title:u?"Odebrat bod":"Klikni pro odemknut\xed",children:i?"...":"−"}),(0,s.jsx)("button",{onClick:m,disabled:n>=3||i,className:"btn-circle ".concat(u?"":"btn-locked"),title:u?"Přidat bod":"Klikni pro odemknut\xed",children:i?"...":"+"})]})]})}},7615:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var s=n(7437),a=n(2265),r=n(6691),o=n.n(r),c=n(6771);function l(e){let{isOpen:t,onClose:n,winners:r,month:l}=e;return((0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,n]),t)?(0,s.jsx)("div",{className:"modal-overlay",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsx)("button",{onClick:n,className:"modal-close",children:"✕"}),(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)(o(),{src:"/images/winner.png",alt:"V\xedtěz",width:80,height:80,className:"winner-icon"}),(0,s.jsx)("h2",{className:"modal-title",children:l.includes("(cel\xfd rok)")?1===r.length?"Celkov\xfd v\xedtěz roku:":"Celkov\xed v\xedtězov\xe9 roku:":1===r.length?"Tenhle měs\xedc chleb\xedčky připravuje:":"Tenhle měs\xedc chleb\xedčky připravuj\xed:"})]}),0===r.length?(0,s.jsxs)("div",{className:"no-winners",children:[(0,s.jsx)("p",{children:"Ž\xe1dn\xfd hr\xe1č nem\xe1 přesně 3 chleb\xedčky"}),(0,s.jsx)("p",{children:"Zkuste to př\xedšt\xed měs\xedc! \uD83E\uDD6A"})]}):(0,s.jsx)("div",{className:"winners-list ".concat(r.length>2?"multiple-winners":""),children:r.map((e,t)=>(0,s.jsxs)("div",{className:"winner-item",style:{animationDelay:"".concat(.2*t,"s")},children:[(0,s.jsx)("div",{className:"winner-avatar",children:(0,s.jsx)(o(),{src:"/avatars/".concat(e.avatar_file),alt:"Avatar ".concat(e.name),width:80,height:80})}),(0,s.jsx)("h3",{className:"winner-name",children:e.name}),(0,s.jsx)("div",{className:"trophy",children:"\uD83C\uDFC6"})]},e.id))}),(0,s.jsx)("div",{className:"modal-footer",children:(0,s.jsx)("p",{className:"month-info",children:l.includes("(cel\xfd rok)")?l:"".concat((0,c.ZY)(l)," ").concat(l.split("-")[0])})})]})}):null}},4114:function(e,t,n){"use strict";n.r(t),n.d(t,{AuthProvider:function(){return c},useAuthContext:function(){return l}});var s=n(7437),a=n(2265);function r(e){let{isOpen:t,onClose:n,onSuccess:r}=e,[o,c]=(0,a.useState)(""),[l,i]=(0,a.useState)(""),[d,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t&&(c(""),i(""))},[t]);let h=async e=>{e.preventDefault(),u(!0),i(""),await new Promise(e=>setTimeout(e,300)),"chlebicky2025"===o?(r(),n()):(i("Nespr\xe1vn\xe9 heslo"),c("")),u(!1)};return t?(0,s.jsx)("div",{className:"modal-overlay password-modal-overlay",onClick:n,children:(0,s.jsxs)("div",{className:"modal-content password-modal-large",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h2",{children:"\uD83D\uDD10 Ověřen\xed př\xedstupu"}),(0,s.jsx)("button",{className:"modal-close",onClick:n,"aria-label":"Zavř\xedt",children:"\xd7"})]}),(0,s.jsx)("div",{className:"modal-body",children:(0,s.jsxs)("div",{className:"password-content",children:[(0,s.jsx)("div",{className:"password-icon",children:"\uD83D\uDD12"}),(0,s.jsx)("h3",{children:"Př\xedstup k \xfaprav\xe1m"}),(0,s.jsx)("p",{children:"Pro přid\xe1n\xed nebo odebr\xe1n\xed bodů zadej heslo:"}),(0,s.jsxs)("form",{onSubmit:h,children:[(0,s.jsxs)("div",{className:"password-input-group",children:[(0,s.jsx)("input",{type:"password",value:o,onChange:e=>c(e.target.value),onKeyDown:e=>{"Escape"===e.key&&n()},placeholder:"Zadej heslo...",className:"password-input-large",autoFocus:!0,disabled:d}),l&&(0,s.jsx)("div",{className:"error-message",children:l})]}),(0,s.jsxs)("div",{className:"password-actions",children:[(0,s.jsx)("button",{type:"button",onClick:n,className:"btn btn-secondary",disabled:d,children:"Zrušit"}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:d||!o.trim(),children:d?"Ověřuji...":"Ověřit"})]})]})]})})]})}):null}let o=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[n,c]=(0,a.useState)(!1),{isAuthenticated:l,authenticate:i,isLoading:d,logout:u}=function(){let[e,t]=(0,a.useState)(!1),[n,s]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("sandwich-auth");if(e){let{timestamp:n}=JSON.parse(e);Date.now()-n<18e5?t(!0):(localStorage.removeItem("sandwich-auth"),t(!1))}else t(!1)}catch(e){console.error("Chyba při kontrole ověřen\xed:",e),t(!1)}finally{s(!1)}})()},[]),{isAuthenticated:e,isLoading:n,authenticate:()=>{try{let e={timestamp:Date.now()};localStorage.setItem("sandwich-auth",JSON.stringify(e)),t(!0)}catch(e){console.error("Chyba při ukl\xe1d\xe1n\xed ověřen\xed:",e)}},logout:()=>{try{localStorage.removeItem("sandwich-auth"),t(!1)}catch(e){console.error("Chyba při odhl\xe1šen\xed:",e)}}}}(),h=()=>{c(!1)};return(0,s.jsxs)(o.Provider,{value:{showPasswordModal:()=>{l||c(!0)},hidePasswordModal:h,isPasswordModalOpen:n,isAuthenticated:l,isLoading:d,logout:()=>{u()}},children:[t,n&&(0,s.jsx)(r,{isOpen:n,onClose:h,onSuccess:()=>{i(),h()}})]})}function l(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuthContext must be used within an AuthProvider");return e}},6771:function(e,t,n){"use strict";n.d(t,{ZY:function(){return a}});let s=["Leden","\xdanor","Březen","Duben","Květen","Červen","Červenec","Srpen","Z\xe1ř\xed","Ř\xedjen","Listopad","Prosinec"];function a(e){return s[parseInt(e.split("-")[1])-1]}},4033:function(e,t,n){e.exports=n(5313)}},function(e){e.O(0,[612,971,938,744],function(){return e(e.s=6777)}),_N_E=e.O()}]);